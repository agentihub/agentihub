#!/usr/bin/env sh

# è·å–æäº¤ä¿¡æ¯
commit_message=$(cat "$1")

# å®šä¹‰æ­£åˆ™ï¼ˆè¿™é‡Œåªèƒ½ç”¨ grep æ ¡éªŒï¼‰
commit_regex="^(feat|fix|docs|style|refactor|test|chore|ci|build|perf|revert)(\\(.+\\))?: .{1,72}"

echo "ğŸ” Checking commit message format..."

# ä½¿ç”¨ grep è€Œä¸æ˜¯ [[ =~ ]]
echo "$commit_message" | grep -Eq "$commit_regex"
if [ $? -ne 0 ]; then
    echo "âŒ Invalid commit message format!"
    echo ""
    echo "Commit message should follow the conventional commits format:"
    echo "  <type>[optional scope]: <description>"
    echo ""
    echo "Types: feat, fix, docs, style, refactor, test, chore, ci, build, perf, revert"
    echo ""
    echo "Examples:"
    echo "  feat: add user authentication"
    echo "  fix(api): resolve CORS issue"
    echo "  docs: update README"
    echo ""
    echo "Your commit message: $commit_message"
    exit 1
fi

echo "âœ… Commit message format is valid!"
